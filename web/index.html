<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compactador de Documentos e Mídias</title>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fluentui/web-components/dist/web-components.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@fluentui/web-components/dist/web-components.min.js"></script>
    <script type="text/javascript" src="/eel.js"></script>
</head>
<body class="ms-Fabric">
    <div class="container">
        <!-- NOVO: Container para notificações -->
        <div id="notificacao-container" style="position:fixed;top:24px;right:24px;z-index:9999;max-width:350px;margin: 10px"></div>

        <header>
            <h1 class="ms-font-su">Compactador de Documentos e Mídias</h1>
            <p class="ms-font-l">Compacte seus arquivos para o formato .fopt e economize espaço</p>
        </header>

        <div class="main-content">
            <div class="tabs">
                <fluent-tabs activeid="tab1">
                    <fluent-tab-panel id="panel-1">
                        <div class="panel-content p-0">
                            <div class="search-section">
                                <h2 class="ms-font-xl">Buscar arquivos grandes</h2>
                                <div class="search-controls left-align">
                                    <fluent-text-field appearance="filled" placeholder="Tamanho mínimo em MB" id="tamanho-minimo" value="250" hidden></fluent-text-field>
                                    <!-- Slider para tamanho mínimo -->
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <label for="slider-tamanho-minimo">Selecione o tamanho mínimo do arquivo: </label>
                                        <input type="range" id="slider-tamanho-minimo" min="10" max="2048" value="250" style="width: 180px;">
                                        <span id="slider-tamanho-label">250 MB</span>
                                    </div>
                                </div>
                            </div>

                            <!-- NOVO: Filtros por tipo de arquivo -->
<div class="file-types-section" style="margin-bottom: 24px;">
    <h3 class="ms-font-l">Tipos de arquivos a monitorar</h3>

    <!-- Documentos -->
    <div class="mb-2 mt-2">
        <strong>Documentos:</strong><br>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".pdf" id="ext_pdf"><label class="form-check-label" for="ext_pdf">.pdf</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".doc" id="ext_doc"><label class="form-check-label" for="ext_doc">.doc</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".docx" id="ext_docx"><label class="form-check-label" for="ext_docx">.docx</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".xls" id="ext_xls"><label class="form-check-label" for="ext_xls">.xls</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".xlsx" id="ext_xlsx"><label class="form-check-label" for="ext_xlsx">.xlsx</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".ppt" id="ext_ppt"><label class="form-check-label" for="ext_ppt">.ppt</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".pptx" id="ext_pptx"><label class="form-check-label" for="ext_pptx">.pptx</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".txt" id="ext_txt"><label class="form-check-label" for="ext_txt">.txt</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".rtf" id="ext_rtf"><label class="form-check-label" for="ext_rtf">.rtf</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".odt" id="ext_odt"><label class="form-check-label" for="ext_odt">.odt</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".csv" id="ext_csv"><label class="form-check-label" for="ext_csv">.csv</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".json" id="ext_json"><label class="form-check-label" for="ext_json">.json</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".xml" id="ext_xml"><label class="form-check-label" for="ext_xml">.xml</label></div>
        <!-- adicione mais se necessário -->
    </div>

    <!-- Imagens -->
    <div class="mb-2">
        <strong>Imagens:</strong><br>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".jpg" id="ext_jpg"><label class="form-check-label" for="ext_jpg">.jpg</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".png" id="ext_png"><label class="form-check-label" for="ext_png">.png</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".gif" id="ext_gif"><label class="form-check-label" for="ext_gif">.gif</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".bmp" id="ext_bmp"><label class="form-check-label" for="ext_bmp">.bmp</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".webp" id="ext_webp"><label class="form-check-label" for="ext_webp">.webp</label></div>
        <!-- adicione mais imagens conforme necessário -->
    </div>

    <!-- Vídeos -->
    <div class="mb-2">
        <strong>Vídeos:</strong><br>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".mp4" id="ext_mp4"><label class="form-check-label" for="ext_mp4">.mp4</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".mkv" id="ext_mkv"><label class="form-check-label" for="ext_mkv">.mkv</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".avi" id="ext_avi"><label class="form-check-label" for="ext_avi">.avi</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".mov" id="ext_mov"><label class="form-check-label" for="ext_mov">.mov</label></div>
    </div>

    <!-- Áudio -->
    <div class="mb-2">
        <strong>Áudio:</strong><br>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".mp3" id="ext_mp3"><label class="form-check-label" for="ext_mp3">.mp3</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".wav" id="ext_wav"><label class="form-check-label" for="ext_wav">.wav</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".flac" id="ext_flac"><label class="form-check-label" for="ext_flac">.flac</label></div>
    </div>

    <!-- Outros -->
    <div class="mb-2">
        <strong>Outros:</strong><br>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".log" id="ext_log"><label class="form-check-label" for="ext_log">.log</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".md" id="ext_md"><label class="form-check-label" for="ext_md">.md</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".eml" id="ext_eml"><label class="form-check-label" for="ext_eml">.eml</label></div>
        <div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".fopt" id="ext_fopt" checked disabled><label class="form-check-label" for="ext_fopt">.fopt (protegido)</label></div>
    </div>
</div>


                            <!-- NOVO: Lista de seleção de pastas -->
                            <div class="folders-section" id="folders-section" style="margin-bottom: 24px;">
                                <h3 class="ms-font-l">Selecione as pastas para monitorar</h3>
                                <!-- Campo de filtro de pastas -->
                                <div style="margin-bottom: 8px;">
                                    <label for="filtro-pastas">Filtrar pastas:</label>
                                    <input type="text" id="filtro-pastas" placeholder="Digite para filtrar..." style="margin-left: 8px; width: 220px;">
                                </div>
                                <!-- Checkbox para selecionar todos -->
                                <div style="margin-bottom: 8px;">
                                    <label>
                                        <input type="checkbox" id="checkbox-selecionar-todos" checked>
                                        Selecionar todos
                                    </label>
                                </div>
                                <div class="folders-container ms-depth-8">
                                    <table class="ms-Table">
                                        <thead>
                                            <tr>
                                                <th>Selecionar</th>
                                                <th>Pasta</th>
                                            </tr>
                                        </thead>
                                        <tbody id="pastas-lista">
                                            <!-- Pastas serão adicionadas aqui dinamicamente -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Botão buscar arquivos logo abaixo do campo de pasta de destino -->
                            <div style="margin-bottom: 18px;">
                                <button id="btn-buscar" class="botao-busca">Iniciar Varredura de Arquivos</button>
                            </div>

                            <div class="progress-section" id="progress-section" style="display: none;">
                                <h3 class="ms-font-l">Progresso da varredura</h3>
                                <fluent-progress id="progress-bar"></fluent-progress>
                                <div class="log-container ms-depth-8" id="log-container">
                                    <div id="log-content"></div>
                                </div>
                            </div>
                            
                            <div class="files-section" id="files-section" style="display: none;">
                                <h3 class="ms-font-l">Arquivos encontrados</h3>
                                <div class="files-container ms-depth-8">
                                    <table class="ms-Table">
                                        <thead>
                                            <tr>
                                                <th><div class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value=".pdf" id="selecione_todos_files"><label class="form-check-label" for="selecione_todos_files"></label></div></th>
                                                <th>Nome</th>
                                                <th>Tamanho</th>
                                                <th>Tipo</th>
                                                <th>Ações</th>
                                            </tr>
                                        </thead>
                                        <tbody id="files-table-body">
                                            <!-- Arquivos serão adicionados aqui dinamicamente -->
                                        </tbody>
                                        <tfoot>
                                            <button class="botao-busca" style="background-color: rgb(0, 120, 212);" disabled>Compactar em Lote</button>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                            <fluent-tab-panel id="panel-2">
                        <div class="panel-content">
                                    <h2 class="ms-font-xl">Arquivos .fopt disponíveis</h2>
                            <div class="files-container ms-depth-8">
                                <table class="ms-Table">
                                    <thead>
                                        <tr>
                                            <th>Nome</th>
                                            <th>Data</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody id="compressed-files-table">
                                        <!-- Arquivos compactados serão adicionados aqui dinamicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </fluent-tab-panel>
                        </div>
                    </fluent-tab-panel>
                    

                </fluent-tabs>
            </div>
        </div>
        
        <footer>
            <p class="ms-font-s">v2.0 - Interface moderna com Fluent UI</p>
        </footer>
    </div>
    
    <!-- Diálogos -->
    <fluent-dialog id="compactar-dialog" hidden>
        <div class="dialog-content" style="display: flex; flex-direction: column; align-items: center;">
            <!-- Spinner GIF centralizado -->
            <img src="https://i.imgur.com/llF5iyg.gif" alt="Carregando..." style="width: 48px; height: 48px; margin-bottom: 16px;">
            <h2 class="ms-font-l" style="text-align: center;">Compactando arquivo...</h2>
            <fluent-progress></fluent-progress>
        </div>
    </fluent-dialog>
    
    <!-- Overlay para operações demoradas (.fopt) -->
    <div class="spinner-overlay" id="spinnerOverlay" style="display: none;">
        <div class="spinner-content">
            <div class="progress" style="height: 20px; width: 200px;">
              <div id="progresso-barra"
                   class="progress-bar progress-bar-striped progress-bar-animated"
                   role="progressbar"
                   style="width: 0%;"
                   aria-valuemin="0"
                   aria-valuemax="100">
                0%
              </div>
            </div>
            <img src="https://i.imgur.com/llF5iyg.gif" alt="Carregando..." width="38" height="38">
            <h2 id="texto-progresso">Processando...</h2>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
